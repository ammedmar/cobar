
\section{Theorem 2}

The goal of this section is to prove \cref{t:2nd main thm in the intro}. This will require some basic constructions and results from homotopy theory, which we will review for completeness. 

\subsection{Kan's loop group construction}

Recall that simplicial sets form a combinatorial model for the homotopy theory of spaces.
This may be expressed using the language of model categories by saying that the adjoint functors
\begin{equation*}
\bars{\ \cdot\ } \colon \sSet \leftrightarrows \mathsf{Top} \colon \sSing
\end{equation*}
defines a Quillen equivalence between model category structures.
%in which the weak equivalences are the weak homotopy equivalences.
We call this model category structure on $\sSet$ the \textit{Kan-Quillen model structure}.
There is also a induced model structure on $\sSet^0$ which we call by the same name.

The based loop space of a reduced simplicial set may be modeled in purely combinatorial terms through the \textit{Kan loop group functor} 
\begin{equation*}
G \colon \sSet^0 \to \mathsf{sGrp}
\end{equation*}
defined as follows.
For any $X \in \sSet^0$ each $G(X)_n$ is the group with one generator $\overline{x}$ for every simplex $x \in X_{n+1}$ modulo the relation $\overline{s_0(x)} = e$.
The face and degeneracy maps are defined by the following equations
\begin{enumerate}
    \item $\delta_0(\overline{x}) = \overline{\delta_1(x)} \cdot (\overline{\delta_0(x)})^{-1}$,
    \item $\delta_n(\overline{x})= \overline{\delta_{n+1}(x)}$ for $n >0$,
    \item $s_n(\overline{x})= \overline{s_{n+1}(x)}$.
\end{enumerate}

Berger showed that this construction models the based loop space \textit{as a topological monoid,} more precisely, he showed that for any $X \in \sSet^0$, the geometric realization of the Kan loop group $|G(X)|$ is weak homotopy equivalent, as a topological monoid, to the based loop space $\Omega|X|$ on the geometric realization of $X$ \cite{berger1995loops}.

One may construct a model category structure on the category $\mathsf{sGrp}$ of simplicial groups such that 
both weak equivalences and fibrations are maps of simplicial groups whose underlying maps of simplicia sets are weak homotopy equivalences and Kan fibrations. We call this model category structure the \textit{Kan model structure on $\sGrp.$}

The Kan loop group functor has a right adjoint usually denoted by 
$$\overline{W} \colon \mathsf{sGrp} \to \sSet^0,$$ which is a model for the classifying space of a simplicial group. This adjunction induces an equivalence of homotopy theories in the following sense.


\begin{theorem} \label{kan}
The adjunction
		$$G \colon \sSet^0 \leftrightarrows \mathsf{sGrp}\colon \overline{W}$$
		becomes a Quillen equivalence when $\sSet^0$ is equipped with the Kan-Quillen model category structure and $\sGrp$ with the Kan model structure.
\end{theorem}

For a proof of the above statement we refer to \cite[Chapter V]{goerss2009simplicial}.

\subsection{Localization of the cubical cobar construction}

The proof that Adams' map in \cref{t:1st main thm in the intro} is a quasi-isomorphism relies on the fibrancy condition of the underlying Kan complex. In general, for an arbitrary reduced simplicial set $X$, the cobar construction $\cobar \schains(X)$ is not naturally quasi-isomorphic to $S^{\cube}(\Omega|X|),$ the singular cubical chains on the based loop space of the geometric realization of $X$. This is true, however, if $X$ is $1$-connected.

In \cite{hess2010cobar}, it is described how to formally invert the elements of $X_1$ inside $\cobar \schains(X)$ to obtain the correct quasi-isomorphism type. The resulting model, called the extended cobar construction, is then compared as an algebra to the chains on the classical the Kan loop group construction $G(X)$. We lift these constructions to the ``space-level" with the goal of comparing the $E_{\infty}$-coalgebra structures after taking chains. 

Denote by $$\mathcal{L} \colon \Mon_{\sSet} \to \sGrp$$ the functor from simplicial monoids to simplicial groups defined by formally inverting all morphisms (degree by degree) subject to the usual relations.
If $M \in \Mon_{\sSet}$ and $A \in M_0$ is a set of $0$-morphisms, we denote by $\mathcal{L}_AM$ the simplicial monoid obtained by formally inverting the elements of $A$, i.e., the pushout
$$\mathcal{L}_AM = M \coprod_{A} \mathcal{L}F(A),$$
where $F(A)$ is the monoid freely generated by the set $A$.

Define 
$$\ncobarE \colon \sSet^0 \to \Mon_{\nSet}$$
as the localization
$$\ncobarE(X)= \mathcal{L}_{X_1} \ncobar(X),$$
namely $\ncobarE(X)$ is the monoidal necklical set obtained by adding to $\ncobar(X)$  formal inverses for all $f\colon \simplex^1 \to X$ (together with the corresponding degenerate elements generated by the new formal inverses) subject to the usual relations.

Finally denote by $$\widehat{\ccobar} \colon \sSet^0 \to \Mon_{\cSet}$$ the composition $$\widehat{\ccobar}= \mathcal{P}_{!} \circ \ncobarE.$$ 

\subsection{Relation to the extended cobar construction.}

Denote $$\A= \cobar \circ \schains \colon \sSet^0 \to \Mon_{\Ch}.$$ The extended cobar construction of \cite{hess2010cobar} is not quite functorial on $\coAlg$ since it depends on a choice of basis of the degree one $R$-module of the underlying coalgebra.
It is, however, functorial with respect to maps of reduced simplicial sets.
Hence, we reinterpret the extended cobar construction as the functor
\begin{equation*}
\Ahat \colon \sSet^0 \to \Mon_{\Ch}
\end{equation*}

given on any $X \in \sSet^0$ by formally inverting the set of $0$-cycles
\begin{equation*}
A_X = \{ [\overline{\sigma}]+1_R \mid \sigma \in X_1 \} \subset \A(X)_0
\end{equation*}
in the associative algebra $\A(X)$.
This construction has the property that, for any $X \in \sSet^0$ there is a natural isomorphism of algebras
\begin{equation*}
H_0(\Ahat(X)) \cong R[\pi_1(X)].
\end{equation*}

As an immediate consequence of \cref{p:ccobar and cobar}, we obtain the following isomorphism after localizing.

\begin{corollary}
	There is a natural isomorphism of functors
	$$\cchains \circ\ \widehat{\ccobar} \cong \Ahat :\sSet^0 \to \Mon_{\Ch}.$$ 
\end{corollary}

\subsection{Rigidification and homotopy coherent nerve}

In order to relate the functors $\widehat{\ccobar} \colon \sSet^0 \to \Mon_{\cSet}$ and $G \colon \sSet^0\to \sGrp$ we introduce a third player, the \textit{rigidification functor} $$\mathfrak{C} \colon \sSet^0 \to \Mon_{\sSet}.$$

This functor is obtained by restricting to $\sSet^0$ a more general construction
$$\mathfrak{C}: \sSet \to \Cat_{\simplex},$$
where $\Cat_{\simplex}$ denotes the category of small categories enriched over the monoidal category $(\sSet, \times)$. 

Given integers $0 \leq  i \leq j$ denote by $P_{i,j}$ the category whose objects are all the subsets of $\{i, i+1, \dots, j\}$ containing both $i$ and $j$ and morphisms are inclusions.
For each integer $n \geq 0$ define $\mathfrak{C}(\simplex^n) \in \Cat_{\simplex}$ to have the set $\{0, \dots, n\}$ as objects and if $i \leq j$, define $\mathfrak{C}(\simplex^n)(i,j)= N(P_{i,j})$, where $N$ is the ordinary nerve functor.
If $j < i$, $\mathfrak{C}(\simplex^n)(i,j) = \emptyset.$ The composition law in $\mathfrak{C}(\simplex^n)$ is induced by the functor $P_{j,k} \times P_{i,k} \to P_{i,k}$ defined as the union of sets.
The assignment $[n] \mapsto \mathfrak{C}(\simplex^n)$ defines a cosimplicial object in $\Cat_{\simplex}$.
For any $S \in \sSet$ we can now define
 $$\mathfrak{C}(S) = \underset{{\simplex^n \to S} }{\text{colim }} \mathfrak{C}(\simplex^n).$$
The functor $\mathfrak{C}$ has a right adjoint, called the \textit{homotopy coherent nerve functor} and denoted by
$$\mathfrak{N} \colon \Cat_{\simplex} \to \sSet,$$ whose $n$-simplices are given by 
$$\mathfrak{N}(\mathcal{C})_n=\text{Hom}_{\Cat_{\simplex}}(\mathfrak{C}(\simplex^n), \mathcal{C}).$$

The homotopy coherent nerve functor was originally introduced by Cordier and further studied by Joyal and Lurie in the theory of $\infty$-categories.
Dugger and Spivak described the construction more explicitly in terms of necklaces in \cite{dugger2011rigidification}.
The adjunction between rigidification and homotopy coherent nerve yield an equivalence of two homotopy theories that model the theory of $\infty$-categories.
The following statement is attributed to both Lurie and Joyal.

\begin{theorem} \label{joyalbergner}
	The adjunction $$ \mathfrak{C} \colon \sSet \leftrightarrows \Cat_{\simplex} :\!\mathfrak{N}$$ induces a Quillen equivalence when $\sSet$ is equipped with the Joyal model structure and $\Cat_{\simplex}$ with the Bergner model structure.
\end{theorem}


\begin{remark}
	The Bergner model structure on $\Cat_{\simplex}$ has as weak equivalences those maps of simplicially enriched categories that induce a weak homotopy equivalence between the simplicial sets of morphisms and are essentially surjective after passing to the homotopy categories.
	Fibrant objects in the Bergner model structure are precisely categories enriched over Kan complexes.
	On the other hand, fibrant objects in the Joyal model structure on $\sSet$ are precisely quasi-categories and all objects are cofibrant.
	The weak equivalences are known as \textit{Joyal equivalences} and, based on the above result, we can take them to be maps of simplicial sets that become weak equivalences of simplicially enriched categories after applying $\mathfrak{C}$.
	Furthermore, the Kan-Quillen model structure is a left Bousfield localization of the Joyal model structure obtained by localizing the single morphism $\simplex^1 \to \simplex^0$.
\end{remark}

The next result relates the cubical cobar construction and the rigidification functor via the triangulation functor as defined in  \cref{ss:triangulation and its adjoint}.

\begin{proposition}\label{Candgcobar}
	The composition 
	$$\mathcal{T} \circ \ccobar \colon \sSet^0 \to \Mon_{\sSet}$$ is naturally isomorphic to
	$$\mathfrak{C} \colon \sSet^0 \to \Mon_{\sSet}.$$
\end{proposition}

The above statement is Proposition 5.3 in \cite{rivera2018cubical}, where $\widehat{\ccobar}$ is denoted by $\mathfrak{C}_{\cube_c}.$

\cref{Candgcobar} also holds in the many-object setting, but we do not need this level of generality for the purposes of this article.




\subsection{The rigidification functor and Kan's loop group construction}

The starting point of the comparison between the rigidification functor and Kan's loop group functor is the following statement about their adjoints, which is Proposition 2.6.2 in \cite{hinich2007deformation}.

\begin{proposition} \label{hinich}
	For any simplicial group $\mathcal{G} \in \mathsf{sGrp}$, we have a natural weak homotopy equivalence
	$$\psi_{\mathcal{G}} \colon \overline{W}(\mathcal{G}) \xrightarrow{\simeq} \mathfrak{N}(\mathcal{G}).$$
\end{proposition} 

We now deduce the following relationship between the rigidification functor $\mathfrak{C}$ and the Kan loop group functor $G$.

\begin{proposition} \label{CandG}
	Let $X \in \sSet^0$ be a reduced simplicial set.
	There are natural weak equivalences of simplicial monoids
	$$\mathcal{L}_{X_1} \mathfrak{C}(X) \xra{\simeq} \mathcal{L}\mathfrak{C}(X) \xra{\simeq} G(X).$$
\end{proposition}

\begin{proof}
	Since $\mathfrak{C}$ is a left Quillen functor and every $X \in \sSet$ is cofibrant in the Joyal model structure, it follows from \cref{joyalbergner} that the simplicially enriched category $\mathfrak{C}(X)$ is a cofibrant.
	Proposition 9.5 of \cite{dwyer1980simplicial} implies that the natural inclusion $\mathcal{L}_{X_1} \mathfrak{C}(X) \to \mathcal{L}\mathfrak{C}(X)$ is a weak equivalence of simplicially enriched categories.
	
	By \cref{hinich} we have that for any $X \in \sSet^0$, $\psi_{G(X)} \colon \overline{W}(G(X)) \xrightarrow{\simeq} \mathfrak{N}(G(X))$ is a weak homotopy equivalence.
	By \cref{kan}, we have a weak homotopy equivalence $X \xrightarrow{\simeq} \overline{W}(G(X))$ given by the unit of the adjunction.
	Composing these two maps we obtain a weak homotopy equivalence
	$$X \xrightarrow{\simeq} \mathfrak{N}(G(X)).$$ 
	The Quillen equivalence of \cref{joyalbergner} localizes to a Quillen equivalence
	$$\mathcal{L} \circ \mathfrak{C} \colon \sSet^0 \leftrightarrows \mathsf{sGrp} \colon \mathfrak{N} \circ \iota$$
	when $\sSet^0$ is equipped with the Kan-Quillen model structure and $\mathsf{sGrp}$ with the model structure of \cref{kan}.
	Here $\iota \colon \mathsf{sGrp} \to \Cat_{\simplex}$ denotes the natural inclusion functor.
	It follows that the adjoint of the weak homotopy equivalence $X \xra{\simeq} \mathfrak{N}(G(X))$ is a weak equivalence of simplicial groups
	$$\mathcal{L}\mathfrak{C}(X) \xra{\simeq} G(X).$$ 
\end{proof}

\subsection{Localized cubical cobar and the Kan loop group}

We have the following comparison between the triangulation of the localized geometric cobar construction and the Kan loop group.

\begin{corollary} \label{widehatgcobarandG}
	Let $X \in \sSet^0$.
	There is a natural weak equivalence of simplicial monoids
	$$\mathcal{T} \widehat{\ccobar}(X) \xrightarrow{\simeq}G(X).$$
\end{corollary}

\begin{proof}
	After localizing the isomorphism of \cref{Candgcobar} at the $1$-simplices, we obtain a natural isomorphism of simplicial monoids
	$$\mathcal{T} \widehat{\ccobar}(X) \cong \mathcal{L}_{X_1}\mathfrak{C}(X).$$
	Hence, the result follows from \cref{CandG}.
\end{proof}

The above statement should be understood as a lift to the level of simplicial sets of Hess and Tonks' map between the extended cobar construction and the chains on the Kan loop group.

\subsection{The map $\Ahat$}

\anibal{The map should be defined outside the proof. It is OK to prove the first half of thm 2 here.}

\subsection{Serre--Cartan comparison map}

We review from \cite{medina2021cubical} the relationship between the $E_\infty$-structures defined on simplicial chains in \cref{ss:e-infty on simplicial} and on cubical chains in \cref{ss:e-infty on cubical}.

In \cite[sect]{serre1951homologie}, the \textit{Serre--Cartan collapse} $\gcube^n \to \gsimplex^n$ was introduced and used to define a natural quasi-isomorphism of coalgebras $\sS(Z) \to \cS(Z)$ for any topological space $Z$.
This map factors as
\begin{equation*}
\chains(\sSing(Z)) \xra{\CS_{\sSing(Z)}}
\cchains(\mathcal{U} \sSing(Z)) \to
\chains(\cSing(Z)),
\end{equation*}
where $\CS_X$, referred to as the \textit{Serre--Cartan comparison map}, is a quasi-isomorphism defined for any simplicial set $X$, whereas the other chain map is induced from a cubical map.

Although both $\schains(X)$ and $\cchains(\mathcal{U} X)$ have natural $\UM$-structures, the map $\CS_X$ is not a morphism of $\UM$-coalgebras for a generic simplicial set $X$.
But, after restriction of their $\UM$-structures to a sub-$E_\infty$-operad, the Cartan-Serre comparison map becomes a morphism of $E_\infty$-coalgebras.
This operad, denoted $\USL$, is generated as a suboperad of $\UM$ by and all immerse graphs of the form
\begin{center}
	\begin{tikzpicture}[scale=1]
	\draw (0,0)--(0,-.6) node[below, scale=.75]{$1$};
	\draw (0,0)--(.5,.5);
	\draw (-.3, .3)-- (-.2,.5) node[scale=.75] at (-.2,.7) {\qquad $1\, \ \ 2\ \ ...\ \ k_1$};
	\draw (-.5,.5)--(0,0);
	\node[scale=.75] at (.11,.4){$...$};
	
	\node[scale=.75] at (1,0){$\cdots$};
	\node[scale=.75] at (1,-.9){$\cdots$};
	
	\draw (2,0)--(2,-.68) node[scale=.75, below]{$r$};
	\draw (2,0)--(2.5,.5);
	\draw (1.7, .3)--(1.8,.5) node[scale=.75] at (1.78,.7) {\qquad $1\, \ \ 2\ \ ...\ \ k_r$};
	\draw (1.5,.5)--(2,0);
	\node[scale=.75] at (2.11,.4){$...$};
	
	\draw (1,2.5)--(1,3) node[scale=.75, above]{$1$};
	\draw (1,2.5)--(0,2) node[scale=.75, below]{$1$};
	\draw (.25,2.125)--(.5,2) node[scale=.75, below]{$2$};
	\draw (.5,2.25)--(1,2) node[scale=.75, below]{$3$};
	\draw (1,2.5)--(2,2) node[scale=.75, below]{\ \quad $n + r$};
	\node[scale=.75] at (1.5,1.75){$\cdots$};
	
	\node[scale=.75] at (1,1.3) {$\vdots$};
	
	\node at (2.85,0){};
	\end{tikzpicture}
\end{center}
where there are no hidden vertices and the strands are joined so that the associated maps $\{1, \dots, k_j\} \to \{1, \dots, n+k\}$ are order-preserving.
From \cite{medina2021cubical} we have the following statement.
\begin{lemma}
	The suboperad $\USL$ of $\UM$ is an $E_\infty$-operad and the Cartan-Serre comparison map
	\begin{equation*}
	\CS_X \colon \schains(X) \to \cchains(\mathcal U X)
	\end{equation*}
	is a natural quasi-isomorphism of $\USL$-coalgebras for any simplicial set $X$.
\end{lemma}

We will denote by $\chains_\USL$ the functor of (cubical or simplicial) chains with its induced $\USL$-structure.

We remark that the inclusion $\As \to \UM$ factors through $\USL$.

\subsection{A zig-zag of $E_\infty$-coalgebras}

\anibal{Please the zig-zag outside the proof}

\subsection{Proof of Theorem 2}

We now put together the constructions and results discussed above to deduce our first main theorem, stated in the introduction as \cref{t:2nd main thm in the intro} and restated here for convenience.

\begin{nntheorem}
	There exists a functor $\Ahat_\UM \colon \sSet^0 \to \Mon_{\coAlg_\UM}$ that fits into a commutative diagram
	\begin{equation*}
	\begin{tikzcd}[row sep=small]
	& \Mon_{\coAlg_\UM} \arrow[d] \\
	& \Mon_{\coAlg} \arrow[d] \\
	\sSet^0
	\arrow[r, "\Ahat"', ]
	\arrow[ru, "\Ahat_{\coAlg}"', out=45, in=180] 
	\arrow[ruu, "\Ahat_\UM", out=90, in=180]
	& \Mon_{\Ch}.
	\end{tikzcd}
	\end{equation*}
	Furthermore, for any $X \in \sSet^0$, there is a zig-zag of natural quasi-isomorphisms of $\USL$-coalgebras between $\Ahat_\USL(X)$ and $\schainsUSL(G(X))$.
\end{nntheorem}

\begin{proof}
	Define the functor
	$$\Ahat_{\UM} \colon \sSet^0 \to \Mon_{\coAlg_{\UM}}$$
	as the composition
	$$\Ahat_{\UM} = \cchainsUM \circ \widehat{\ccobar}.$$
	The commutativity of the desired diagram is straightforward by construction.
	
	We now construct a zig-zag of quasi-isomorphisms of $E_{\infty}$-coalgebras between $\cchainsUSL(\widehat{\ccobar}(X)) = \Ahat_{\USL}(X)$ and $\schainsUSL (G(X))$ using the $E_{\infty}$ suboperad $\USL$ of $\UM$, which is suitable for comparing simplicial and cubical chains.
	
	\manuel{the following should just obtained by referencing the corresponging statement in the previous section about serre comparison map.}
	
	For any $C \in \cSet$ there are quasi-isomorphisms of $\USL$-coalgebras
	\begin{equation} \label{e:zig-zag of quasi-isos}
	\schainsUSL(\mathcal{T}C) \xra{\simeq}
	\cchainsUSL(\mathcal{U}\mathcal{T}C) \xleftarrow{\simeq}
	\cchainsUSL(C).
	\end{equation}	
	The first map $\schainsUSL(\mathcal{T}C) \to \cchainsUSL(\mathcal{U}\mathcal{T}C)$ is induced by the Serre collapse map.
	This is a natural map
	$$\schains(S) \to \cchains(\mathcal{U}S)$$
	defined for any simplicial set $S \in \sSet.$
	The fact that this is a quasi-isomorphism follows from a standard acyclic models argument by taking the set of simplicial cubes $\{ \simplex^0, \simplex^1, (\simplex^1)^{\times 2}, \dots\}$ as the collection of acyclic models inside $\sSet$. This map preserves the $\USL$-coalgebra structure by \cite{medina2021cubical}.
	
	The second map in \eqref{e:zig-zag of quasi-isos} is induced by the morphism of cubical sets $C \to \mathcal{U} \mathcal{T} (C)$ given by the unit of the adjunction
	$$\mathcal{T} \colon \cSet \leftrightarrows \sSet \colon \mathcal{U}.$$
	The unit map is in fact a weak homotopy equivalence of cubical sets since the adjunction defines a Quillen equivalence between the Kan-Quillen model structure and an analogue model structure on $\cSet$ in which all objects are cofibrant \cite{cisinski2006presheaves}.
	
	Hence, by naturality, the unit map induces a quasi-isomorphism of $\USL$-coalgebras after applying cubical chains.
	
	Applying the above to $C= \widehat{\ccobar}(X),$ we obtain that $\schainsUSL (\mathcal{T} \widehat{\ccobar}(X))$ and $\cchainsUSL(\widehat{\ccobar}(X)) = \Ahat_{\USL}(X)$ are quasi-isomorphic as $\USL$-coalgebras.
	
	By \cref{widehatgcobarandG} we have a weak equivalence of simplicial monoids
	$$\mathcal{T}\widehat{\ccobar}(X) \xrightarrow{\simeq} G(X)$$ for any $X \in \sSet^0.$ By naturality, we have an induced quasi-isomorphism of $\UM$-coalgebras
	$$\schainsUSL(\mathcal{T}\widehat{\ccobar}(X)) \xra{\simeq} \schainsUSL(G(X)).$$
	Therefore, $\Ahat_{\USL}(X)$ and $\schainsUSL(G(X))$ are quasi-isomorphic as $\USL$-coalgebras, as desired.
\end{proof}