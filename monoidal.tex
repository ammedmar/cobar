
\section{Monoidal properties}

The first goal of this section is to construct a monoidal structure on $\coAlg_\UM$.
We will do so by providing $\M$ with the structure of a Hopf prop.
Then, we will show that the functor $\cchainsUM \colon \cSet \to \coAlg_{\UM}$ defined in \eqref{e:lift of cubical chains to UM-coalgs} is monoidal.
Finally, we will use this fact and the cubical cobar construction, a monoid in $\cSet$, to provide $\cobar(\schains(X))$ with the structure of an $E_\infty$ bialgebra, specifically, of a monoid in $\coAlg_{\UM}$

\subsection{Cartesian product and Day convolution} \label{ss:day convolution}

\anibal{Cartesian for simplicial sets}

\anibal{Day for cubical sets} 

\anibal{singular complex and realization realization in both cases: monoidal comments}

\subsection{Triangulation and its right adjoint} \label{ss:triangulation and its adjoint}

Simplicial and cubical sets can be related using the the simplicial cubes $(\simplex^1)^{\times n}$.

The \textit{triangulation} functor $\mathcal{T} \colon \cSet \to \sSet$ is defined by
\begin{equation*}
\mathcal{T}(Y) = \colim_{\cube^n \to Y} (\simplex^1)^{\times n}.
\end{equation*}
It has a right adjoint $\mathcal{U} \colon \sSet \to \cSet$ which is given by the formula
\begin{equation*}
\mathcal{U}(X)_n = \sSet((\simplex^1)^{\times n}, X).
\end{equation*}

With the monoidal structure defined in \cref{ss:day convolution}, the triangulation functor is monoidal.
Thus, it induces a functor
\begin{equation*}
\mathcal{T} \colon \Mon_{\cSet} \to \Mon_{\sSet}
\end{equation*}
between the associated categories of monoids.

\subsection{Serre coalgebra} \label{ss:serre coalgebra sym monoidal}

Recall that both $\Ch$ and $\coAlg$ are symmetric monoidal categories.
If $\cSet$ to be equipped with the Day convolution symmetric monoidal structure \cref{ss:day convolution}, then the functors $\cchains$ and its lift $\cchainsAS$ are symmetric monoidal.
Together with straightforward computations, these statements follow from the fact that the chain complexes $\chains(\cube^p) \otimes \chains(\cube^q)$ and $\chains(\cube^{p+q})$ are canonically isomorphic for any $p, q \geq 0$.

For later reference we record the following consequence of the previous claims and the fact that, for any coalgebra, the braiding $x \otimes y \mapsto (-1)^{\bars{x} \bars{y}} y \otimes x$ is a morphism of coalgebras.

\begin{lemma} \label{l:serre diagonal invariant}
	Let $\sigma \in \S_d$ acting on $\chains(\cube^1)^{\otimes d}$ by permuting tensor factors, then
	\begin{equation*}
	\begin{tikzcd}
	\chains(\cube^1)^{\otimes d} \arrow[r, "\Delta"] \arrow[d, "\sigma"] &
	\chains(\cube^1)^{\otimes d} \otimes \chains(\cube^1)^{\otimes d} \arrow[d, "\sigma \otimes \sigma"] \\
	\chains(\cube^1)^{\otimes d} \arrow[r, "\Delta"] &
	\chains(\cube^1)^{\otimes d} \otimes \chains(\cube^1)^{\otimes d}.
	\end{tikzcd}
	\end{equation*}
\end{lemma}

\subsection{Hopf operads and props}

So far we have consider operad and props over the category $\Ch$ but, since $\coAlg$ is also a symmetric monoidal category, we can consider them over $\coAlg$.
That is to say, demand that all defining chain complexes be coalgebras, and composition maps be morphisms of coalgebras.
We refer to operads and props over $\coAlg$ as \textit{Hopf operads and props} respectively.

If $\O$ is a Hopf operad, the category $\coAlg_\O$ is monoidal.
The structure maps of a product of $\O$-coalgebras $C \otimes C^\prime$ are given by
\begin{equation*}
\begin{tikzcd} [column sep = normal, row sep=large]
\O(r) \otimes (C \otimes C^\prime) \arrow[r, "\Delta_\O \otimes \id"] &[10 pt] \O(r) \otimes \O(r) \otimes (C \otimes C^\prime) \arrow[d, "Sh"'] & & \\ &
\big(\O(r) \otimes C \big) \otimes \big( \O(r) \otimes C \big) \arrow[r] & 
C^{\otimes r} \otimes C^{\prime\, \otimes r} \arrow[r, "Sh"] &
(C \otimes C^\prime)^{\otimes r}.
\end{tikzcd}
\end{equation*}

A similar statement holds for the category of representations of a Hopf prop $\P$.

\subsection{Cubical structure on $\M$}

We will now revisit from \cref{ss:definition of M} the definition of $\M$ and provide this prop with a cubical structure.
We will use this to make it into a Hopf prop in the next subsection.

We start with a general observation.
As explained in \cref{ss:free constructions}, the $(m,n)$-part of the free prop generated by an $\S$-module $N$ is given by
\begin{equation*}
\F(N)(m,n) \ = \bigoplus_{\Gamma \in \G(m,n)} \bigotimes_{v \in Vert(\Gamma)} out(v) \otimes_{\S_q} N(p, q) \otimes_{\S_p} in(v),
\end{equation*}
which is well defined only up to a choice of total order on the set of vertices of the $(m,n)$-graphs involved.

In the case we are concern with, the free prop whose quotient defines $\M$ is generated by an $\S$-bimodule $M$ with
\begin{equation*}
M(1,0) = \k \left\{ \; \counit \ \right\}, \qquad
M(1,2) = \k[\S_2] \left\{ \; \coproduct \ \right\}, \qquad
M(2,1) = \k[\S_2^\op] \left\{ \partial_0\! \product \, \right\} \xleftarrow{1 - T} \k[\S_2^\op] \left\{ \, \product \; \right\},
\end{equation*}
and $M(m,n) = 0$ otherwise.
We notice that the elements $\rightboundary\,$ and $\,\leftboundary\,$ in $\F(M)(2,1)$ are interchanged by the action of $T \in \S_2^\op$.
Let $\widetilde{\M}$ be the quotient of $\F(M)$ by the ideal generated by the identification of $\,\partial_0\! \product$ and $\,\rightboundary\,$, so that the boundary of $\product$ is $\,\boundary\,$.
Consider a basis element of $\widetilde{\M}(m,n)_d$ represented by an immersed $(m,n)$-graph $\Gamma$ with $d$ occurrences of $\product.$
A choice of total order of the vertices of $\Gamma$ defines a chain map
\begin{equation} \label{e:order chain map}
\begin{tikzcd}[row sep=tiny, column sep=small]
\iota_\Gamma \colon \chains(\cube^d) \arrow[r] & \widetilde{\M}(m,n) \\
\qquad {[0,1]}^{\otimes d} \arrow[r, |->] & \Gamma,
\end{tikzcd}
\end{equation}
referred to as the \textit{characteristic map of $\Gamma$}.
We obtain characteristic maps on $\M$ simply by composing these with the projection $\widetilde{\M} \to \M$ induced from the quotient by the prop ideal generated by the relations \eqref{e:relations of M}.

\subsection{Hopf structure on $\M$}

We now use the existence of characteristic maps on $\M$ to show it is a prop over $\coAlg$.
We will show the following is well defined in \cref{t:cubical structure on M}.

\begin{definition}
	The \textit{coproduct} $\Delta_\M \colon \M \to \M^{\otimes 2}$ is defined on basis elements $\Gamma$ by
	\begin{equation*}
	\Delta_{\M}(\Gamma) = \iota_\Gamma^{\otimes 2} \circ \Delta \left( [0,1]^{\otimes d} \right),
	\end{equation*}
	where $d = \bars{\Gamma}$, and the \textit{counit} $\epsilon_\M \colon \M \to \k$ by requiring $\epsilon_M(\Gamma) = 1$ if the degree of $\Gamma$ is $0$, where $\k$ is though of as a Hopf prop.
\end{definition}

\begin{theorem} \label{t:cubical structure on M}
	The maps $\Delta_\M$ and $\varepsilon_\M$ are well defined and make $\M$ into a Hopf prop.
\end{theorem}

\begin{proof}
	By \cref{l:serre diagonal invariant} these maps are independent of the total order on vertices used to define characteristic maps.
	
	The linear map $\Delta_\M$ is compatible with the relations defining $\M$ since
	\begin{center}
		\begin{tikzcd}
		\leftcounitcoproduct \arrow[r, "\Delta_\M"] \arrow[d, <->] &[-0pt] \leftcounitcoproduct \otimes \leftcounitcoproduct \arrow[d, <->] \\
		\identity \arrow[r, "\Delta_\M"] & \ \, \identity \otimes \identity \, ,
		\end{tikzcd}
		\qquad
		\begin{tikzcd}
		\rightcounitcoproduct \arrow[r, "\Delta_\M"] \arrow[d, <->] &[-0pt] \rightcounitcoproduct \otimes \rightcounitcoproduct \arrow[d, <->] \\
		\identity \arrow[r, "\Delta_\M"] & \ \, \identity \otimes \identity \, ,
		\end{tikzcd}
		\qquad
		\begin{tikzcd}
		\leftcomb \arrow[r, "\Delta_\M"] \arrow[d, <->] &[-0pt] \leftcomb \, \otimes \leftcomb \arrow[d, <->] \\
		\rightcomb \arrow[r, "\Delta_\M"] & \, \rightcomb \, \otimes \rightcomb,
		\end{tikzcd}
		\qquad
		\begin{tikzcd}
		\productcounit \arrow[r, "\Delta_\M"] \arrow[d, <->] &[-0pt] \counit\ \counit \, \otimes \productcounit + \productcounit \otimes \, \counit\ \counit \arrow[d, <->] \\
		0 \arrow[r, "\Delta_\M"] & \ 0,
		\end{tikzcd}
	\end{center}
	and it is a chain map since
	\begin{center}
		\begin{tikzcd}
		\counit \arrow[r, "\Delta_\M"] \arrow[d, "\partial"'] &[-0pt] \counit \otimes \counit \arrow[d, "\partial"'] \\
		0 \arrow[r, "\Delta_\M"] & \ \, 0 \, ,
		\end{tikzcd}
		\qquad
		\begin{tikzcd}
		\coproduct \arrow[r, "\Delta_\M"] \arrow[d, "\partial"'] &[-0pt] \coproduct \otimes \coproduct \arrow[d, "\partial"'] \\
		0 \arrow[r, "\Delta_\M"] & \ \, 0 \, ,
		\end{tikzcd}
		\qquad
		\begin{tikzcd}
		\product \arrow[r, "\Delta_\M"] \arrow[d, "\partial"'] &[-0pt] \leftboundary \ \otimes \product + \product \otimes\ \rightboundary \arrow[d, "\partial"'] \\
		\rightboundary \,-\, \leftboundary \arrow[r, "\Delta_\M"] &
		\, \rightboundary \otimes \rightboundary \,-\, \leftboundary \otimes \leftboundary\,.
		\end{tikzcd}
	\end{center}	
	One can check similarly that $\varepsilon_\M$ is a well defined morphism of $\S$ bimodules.
	
	The fact that for any biarity $(m,n)$ the triple $(\M(m,n), \Delta_\M(m,n), \epsilon_\M(m,n))$ is a coalgebra follows from the Serre structure \cref{ss:serre coalgebra} being a coalgebra.
	
	Furthermore, $\Delta_\M$ is compatible with the composition structure since for any pair of characteristic maps $\iota_\Gamma$ and $\iota_{\Gamma^\prime}$, the chain map $\iota_\Gamma \otimes \iota_{\Gamma^\prime}$ is a characteristic map for any composition of $\Gamma$ and $\Gamma^\prime$ with the induce order on vertices.
	The compatibility of $\epsilon_\M$ is immediate.
\end{proof}

\subsection{Monoidal $E_\infty$ structures}

We now prove the main technical result of this paper.

\begin{theorem} \label{t:cubical e-infty chains are monoidal}
	The functor $\cchainsUM \colon \cSet \to \coAlg_\UM$ is monoidal.
\end{theorem}

\begin{proof}
	It suffices to prove this result for chains on the standard cubes.
	These are equipped with a natural $\M$-structure, and we will prove the stronger statement that the functor $\mathrm{N}^\cube_\M \colon \cube \to \biAlg_{\M}$ is monoidal.
	
	From \cref{ss:serre coalgebra sym monoidal} we know that the Serre diagonal and the augmentation map are compatible with the monoidal structure on the site $\cube$.
	We need to establish this for the map $\ast$, the image of the generator $\product$.
	Diagrammatically, this is equivalent to the commutativity of
	\begin{equation} \label{e:hopf diagonal and the product}
	\begin{tikzcd}
	\product \otimes \chains(\cube^{p+q})^{\otimes 2} \arrow[d] \arrow[r, "\Delta_\M \otimes Sh"] &[20pt]
	\left(\, \ \leftboundary \ \otimes \product + \product \otimes \ \rightboundary \ \, \right) \otimes \chains(\cube^{p})^{\otimes 2} \otimes \chains(\cube^{q})^{\otimes 2} \arrow[d]\\
	\chains(\cube^{p+q}) \arrow[r, "\cong"] &
	\, \chains(\cube^{p}) \otimes \chains(\cube^{q}).
	\end{tikzcd}
	\end{equation}
	
	Since this commutativity is immediate for $p = 0$ or $q = 0$ and $\chains(\cube^n) \cong \chains(\cube^1)^{\otimes n}$, we only need to verify the commutativity of this diagram for $p = q = 1$.
	
	Consider $(x_1 \otimes y_1) \otimes (x_2 \otimes y_2) \in \chains(\cube^1)^{\otimes 2} \otimes \chains(\cube^1)^{\otimes 2}$.
	We have
	\begin{equation*}
	\begin{split}
	\big((\id \otimes \varepsilon) \otimes \ast \ + \ \ast \otimes (\varepsilon \otimes \Delta)\big) \ (-1)^{\bars{y_1} \bars{x_2}} \ (x_1 \otimes x_2) \otimes (y_1 \otimes y_2) \ & = \\
	(-1)^{\bars{y_1} \bars{x_2} + \bars{x_1} + \bars{x_2} + \bars{y_1}} \ x_1 \cdot \varepsilon(x_2) \otimes y_1 \ast y_2 \ & + \ 
	(-1)^{\bars{y_1} \bars{x_2} + \bars{x_1}} \ x_1 \ast x_2 \otimes \varepsilon(y_1) \ast y_2.
	\end{split}
	\end{equation*}
	The first summand on the left hand side is non-zero only if $\bars{x_2} = \bars{y_1} = \bars{y_2} = 0$, whereas the second is non-zero only if $\bars{x_1} = \bars{x_2} = \bars{y_1} = 0$, so the above is also equal to
	\begin{equation} \label{e:join is monoidal 1}
	(-1)^{\bars{x_1}} \ x_1 \cdot \varepsilon(x_2) \otimes y_1 \ast y_2 \ + \ 
	x_1 \ast x_2 \otimes \varepsilon(y_1) \ast y_2.
	\end{equation}
	On the other hand,
	\begin{align*}
	(x_1 \otimes y_1) \ast (x_2 \otimes y_2) \ & =\ 
	(-1)^{\bars{x_1} + \bars{y_1}} \ (x_1 \ast x_2) \otimes \varepsilon(y_1) \cdot y_2 \ +\
	(-1)^{\bars{x_1} + \bars{y_1}} \ x_1 \cdot \varepsilon(x_2) \otimes (y_1 \ast y_2) \\ \ & =\ 
	(x_1 \ast x_2) \otimes \varepsilon(y_1) \cdot y_2 \ +\
	(-1)^{\bars{x_1}} \ x_1 \cdot \varepsilon(x_2) \otimes (y_1 \ast y_2),
	\end{align*}
	which is equal to \eqref{e:join is monoidal 1} as claimed.
\end{proof}

%	In diagrammatic terms,
%	\begin{equation*}
%	\begin{tikzcd}
%	\coproduct \otimes \chains(\cube^{p+q}) \arrow[r, "\Delta_\M \otimes Sh"] \arrow[d] &[20pt]
%	\left( \ \coproduct \otimes \coproduct \ \right) \otimes
%	\chains(\cube^{p}) \otimes \chains(\cube^{q}) \arrow[d] \\
%	\chains(\cube^{p+q})^{\otimes 2} \arrow[r, "Sh"] &
%	\chains(\cube^{p})^{\otimes 2} \otimes \chains(\cube^{q})^{\otimes 2}
%	\end{tikzcd}
%	\end{equation*}
%	and
%	\begin{equation*}
%	\begin{tikzcd}
%	\counit \ \otimes \chains(\cube^{p+q}) \arrow[r, "\Delta_\M \otimes Sh"] \arrow[d] &[20pt]
%	\left( \ \counit \ \otimes \ \counit \ \right) \otimes
%	\chains(\cube^{p}) \otimes \chains(\cube^{q}) \arrow[d] \\
%	R \arrow[r, "\cong"] &
%	R \otimes R
%	\end{tikzcd}
%	\end{equation*}
%	commute.
