
\section{Introduction}

In 1956, F. Adams introduced the cobar construction to model algebraically the passage from a simply connected pointed space to its topological monoid of based loops \cite{adams1956cobar}.
Fixing a commutative ring, the algebraic cobar construction may be described as a functor $\cobar \colon \coAlg^\ast \to \Mon_{\Ch}$ from the category of coaugemented (differential graded coassociative) coalgebras to the category of (dga) algebras, which we regard in this article as monoids over the symmetric monoidal category $\Ch$ of chain complexes.
For any pointed space $(Z, z)$, Adams constructed a \textit{comparison map}
\begin{equation} \label{e:adams map}
\theta_Z \colon \cobar \sS(Z, z) \to S^{\cube}(\loops_z Z),
\end{equation}
i.e., a natural chain map of algebras, where $\sS(Z,z)$ is a pointed version of the coalgebra of (simplicial) singular chains in $Z$ and $S^{\cube}(\loops_zZ)$ is the algebra of cubical singular chains on the topological monoid of Moore loops in $Z$ based at~$z$.
More precisely, $\sS(Z,z)$ is the coaugmented coalgebra obtained by applying the functor of (normalized) chains $\schains$, equipped with the Alexander-Whitney coproduct, to the pointed simplicial singular complex $\sSing(Z, z)$ of continuous maps $\gsimplex^n \to Z$ sending all vertices to $z$.
The construction of $\theta_Z$ uses a particular way of decomposing an $n$-simplex into a family of paths parameterized by the $(n-1)$-cube.
Adams proved that $\theta_Z$ is a quasi-isomorphism if $Z$ is simply connected, a result extended to path-connected spaces in \cite{rivera2018cubical} by considering finer homotopical algebra, and in \cite{hess2010cobar} by a localization procedure.

In this article we study the interplay between the geometric, combinatorial, and algebraic structures arising from the cobar construction and its relationship to the based loop space.
Our starting point is an insight of H.~Baues which is best explained in terms of \textit{cubical sets (with connections)}, i.e., presheaves over the
strict monoidal category generated by the diagram
\[
\begin{tikzcd}
1 \arrow[r, out=45, in=135, "\delta^0"] \arrow[r, out=-45, in=-135, "\delta^1"'] & 2 \arrow[l, "\sigma"'] &[-10pt] \arrow[l, "\gamma"'] 2 \times 2
\end{tikzcd}
\]
restricted by certain relations \cite{brown1981cubes, grandis2003cubical}.

The functor of cubical singular chains $S^\cube$ appearing in the target of Adams' comparison map \eqref{e:adams map} is equal to the composition $\cchains \cSing$, where $\cSing$ is constructed by considering all continuous maps from geometric cubes and $\cchains$ is the (normalized) cubical chains functor.

The monoidal structure on the site defining the category of cubical sets $\cSet$ provides it, via Day convolution, with a monoidal structure, which, with the usual monoidal structures on $\Ch$ and $\Top$, makes both $\cSing$ and $\cchains$ into monoidal functors.
Consequently, $S^\cube(\loops_z Z)$ is a monoid in $\Ch$ since $\loops_z Z$ is a monoid in $\Top$ for any pointed space $(Z, z)$.
Cubical chains are equipped with a natural coalgebra structure coming from Serre's chain approximation to the diagonal.
This structure lifts $\cchains$ to the category of coalgebras $\cchainsAs \colon \cSet \to \coAlg$ as a monoidal functor, which, in particular, makes $S^\cube(\loops_z Z)$ into a monoid in $\coAlg$ for any pointed space $(Z, z)$.

Denoting by $\sSet^0$ the category of reduced simplicial sets, we reinterpret Baues' geometric cobar construction from \cite{baues1998hopf} as a functor
\[
\ccobar \colon \sSet^0 \to \Mon_{\cSet},
\]
which we call the \textit{cubical cobar construction}.
There are two key differences between this construction and Baues' geometric cobar construction.
First, Baues worked in the context of $1$-reduced simplicial sets, while we extend his construction to reduced simplicial sets in order to treat the case of non-simply connected spaces.
Second, we equip cubical sets with the extra data of connections, which may be thought of as an additional set of degeneracy maps, in order to obtain a functorial construction with respect to maps of reduced simplicial sets before geometrically realizing the monoidal cubical set.
Adams' comparison map factors as a composition
\begin{equation} \label{e:baues factorization of adams map}
\begin{tikzcd}[column sep = small]
\theta_Z \colon \cobar \sS(Z, z) \arrow[r] &
\cchains(\ccobar \sSing(Z, z)) \arrow[r] &
S^{\cube}(\loops_z Z),
\end{tikzcd}
\end{equation}
where the first chain map is an isomorphism and the second is induced from an inclusion of cubical sets $\ccobar \sSing(Z, z) \to \cSing(\loops_z Z)$.
Baues proved that when $Z$ is simply connected this inclusion is a homotopy equivalence after geometrically realizing, a result extended to the non-simply connected setting in \cite{rivera2019path}.

The first map in \eqref{e:baues factorization of adams map} is defined for a general reduced simplicial set $X$ and it is always an isomorphism.
Using this map, we follow Baues' idea of transferring the Serre coproduct on $\cchainsAs(\ccobar X)$ to $\cobar \schains(X)$.
This coproduct makes $\cobar \schains(X)$ into a bialgebra, that is to say, a monoid in $\coAlg$.

In other words, Adams' cobar construction $\cobar \schains$ may be lifted so that it fits in the following diagram commuting up to a natural isomorphism:
\[
\begin{tikzcd}
\Mon_{\cSet} \arrow[r, "\cchainsAs \ "] & \Mon_{\coAlg} \arrow[d] \\
\sSet^0 \arrow[r, "\cobar \schains"] \arrow[u, "\ccobar"] & \Mon_{\Ch}.
\end{tikzcd}
\]
Furthermore, when $(Z, z)$ is a pointed space, Adams' comparison map $\theta_Z \colon \cobar \sS(Z, z) \to S^{\cube}(\loops_z Z)$ is a quasi-isomorphism of bialgebras, i.e., of monoids in $\coAlg$.

We extend Baues' work by lifting $\cobar \schains$ to the category of $E_{\infty}$-\textit{bialgebras}, that is to say, of monoids in $E_{\infty}$-\textit{coalgebras}; a notion that should not be confused with that of bialgebras over an $E_{\infty}$-prop.
An $E_{\infty}$-coalgebra is essentially a coalgebra that is commutative up to an infinite family of coherent homotopies which is regarded as extra structure.
This algebraic structure is conveniently defined using the framework and language of operads.
We construct a lift of $\cchainsAs \ccobar \colon \sSet^0 \to \Mon_{\coAlg}$ to the category of monoids in $\coAlg_\UM$, where $\coAlg_\UM$ is the category of coalgebas over the operad $\UM$ introduced via a finitely presented prop in \cite{medina2020prop1}.
This is a model of the $E_\infty$-operad that explicitly acts on both simplicial and cubical chains.
For this lift to be meaningful, we first need to define a monoidal structure on $\coAlg_\UM$.
We do so by introducing a Hopf structure on $\UM$, that is to say, by making it into an operad over the category of coalgebras, a structure that has other potential applications \cite{livernet2008hopf}.
Once we have shown that $\coAlg_\UM$ is a monoidal category, we prove the main technical result of this work, stating that the lift $\cchainsUM \colon \cSet \to \coAlg_\UM$ of $\cchainsAs$ defined in \cite{medina2021cubical} is monoidal.

Generalizing Baues' first step in the construction of his lift of Adams' cobar construction, we have that $\cchainsUM(\ccobar X)$ is a monoid in $\coAlg_\UM$.
This is because $\ccobar X$ is a monoid in $\cSet$ and $\cchainsUM$ is shown to be a monoidal functor.
Then, for any reduced simplicial set $X$, we use the natural isomorphism $\cobar \schains(X) \to \cchains(\ccobar X)$ to transfer the constructed $E_{\infty}$-bialgebra structure on $\cchains(\ccobar X)$ to $\cobar \schains(X)$.
In particular, for any pointed space $(Z, z)$ Adams' comparison map $\theta_Z \colon \cobar \sS(Z, z) \to S^{\cube}(\loops_z Z)$ is a quasi-isomorphism of $E_{\infty}$-bialgebras.
We condense this discussion in our main result.

\begin{theorem} \label{t:1st main thm in the intro}
	The functor $\cchainsUM$ is monoidal and its associated functor on monoids fits in the following diagram commuting up to a natural isomorphism:
	\[
	\begin{tikzcd}
	& \Mon_{\coAlg_\UM} \arrow[d] \\
	\Mon_{\cSet} \arrow[ru, "\cchainsUM", out=70, in=180] \arrow[r, "\cchainsAs"]
	& \Mon_{\coAlg} \arrow[d] \\
	\sSet^0 \arrow[r, "\cobar \schains"] \arrow[u, "\ccobar"]
	& \Mon_{\Ch}.
	\end{tikzcd}
	\]
	Furthermore, when $(Z, z)$ is a pointed space, Adams' comparison map $\theta_Z \colon \cobar \sS(Z, z) \to S^{\cube}(\loops_z Z)$ is a quasi-isomorphism of $E_{\infty}$-bialgebras or, more specifically, of monoids in $\coAlg_\UM$.
\end{theorem}

We turn now to a second result in this work.
The homotopy theory of spaces can be modeled as the Kan-Quillen model category of simplicial sets.
We would also like to understand how the cobar construction and its algebraic structure fit in this combinatorial framework.
A model in this context for the based loop space of an arbitrary reduced simplicial set is given by the classical \textit{Kan loop group functor}.
This is a functor
\[
\kan \colon \sSet^0 \to \sGrp
\]
from reduced simplicial sets to the category of simplicial groups with the property that the geometric realization $|\kan(X)|$ is homotopy equivalent to the based loop space $\loops_b|X|$ as a topological monoid \cite{berger1995loops}.
Furthermore, the Kan loop group together with its right adjoint define a Quillen equivalence of model categories when $\sSet^0$ is equipped with the Kan-Quillen model category structure and $\sGrp$ with an appropriate model structure, having as weak equivalences maps of simplicial groups whose underlying maps of simplicial sets are weak homotopy equivalences.

In \cite{mcclure2003multivariable, berger2004combinatorial}, the functor of (normalized) chains $\schains$ was lifted to that of $E_{\infty}$-coalgebras, a result generalized in \cite{medina2020prop1} using a lift $\schainsUM \colon \sSet \to \coAlg_{\UM}$.
Hence, a natural problem is to compare the algebraic structures in $\cobar \schains(X)$ and $\schains_{\UM}(\kan(X))$.
In general, $\cobar \schains(X)$ and $\schains(\kan(X))$ are not quasi-isomorphic for an arbitrary reduced simplicial set $X$.
This can be seen from the fact that, if $X$ is not fibrant, $H_0(\cobar \schains(X))$ need not be a group ring, while $H_0(\kan(X))$ is always isomorphic to $ \k[\pi_1(|X|)]$.

K. Hess and A. Tonks proposed a way of modifying the cobar construction so that it could be compared to the chains on the Kan loop group \cite{hess2010cobar}.
They construct a localized version of the cobar construction, called \textit{extended cobar construction}, which we interpret as a functor
\[
\Ahat \colon \sSet^0 \to \Mon_\Ch
\]
extending the composition
\[
\A \defeq \cobar \schains \colon \sSet^0 \to \Mon_\Ch
\]
by formally inverting a basis of $0$-degree elements in $\mathcal{A}(X)$ determined by the $1$-simplices of $X$ for any reduced simplicial set $X$.
Hess and Tonks also describe a natural quasi-isomorphism of algebras
\[
\phi_X \colon \Ahat(X) \to \schains(\kan(X))
\]
in terms of a sequence of simplicial operators known as the \textit{Szczarba operators}.

Following Baues’ construction, Franz described in \cite{franz2020szczarba} a lift of $\Ahat$ to a functor
\[
\Ahat_{\coAlg} \colon \sSet^0 \to \Mon_{\coAlg}
\]
and showed that Hess--Tonks' comparison map preserves the coalgebra structure, namely, it induces a natural quasi-isomorphism of bialgebras
\[
\phi_X \colon \Ahat_{\coAlg}(X) \to \schains (\kan(X)).
\]

Using similar methods to those that lead to \cref{t:1st main thm in the intro}, we construct a further lift
\[
\Ahat_\UM \colon \sSet^0 \to \Mon_{\coAlg_\UM}.
\]
We may now try to compare the above functor with the Kan loop group construction via Hess and Tonk's comparison map.
However, there is a fundamental asymmetry between the interaction of the cubical chains and simplicial chains with the monoidal structures that we have to take into account.
For any two cubical sets $Y$ and $Y'$ the isomorphism
\[
\cchains(Y) \otimes \cchains(Y') \xrightarrow{\cong} \cchains(Y \otimes Y')
\]
preserves the $\UM$-coalgebra structures.
However, for any two simplicial sets $X$ and $X^\prime$, the Eilenberg-Zilber shuffle map
\[
\schains(X) \otimes \schains(X^\prime) \xrightarrow{\simeq} \schains(X \times X^\prime)
\]
is a quasi-isomorphism of coassociative coalgebras but not of $\UM$-coalgebras.
This last point has two important manifestations: 1) the $\UM$-coalgebra structure of $\schainsUM(\kan(X))$ is not (strictly) compatible with the algebra structure, i.e. it is not an $E_{\infty}$-bialgebra in our sense, and 2) the Hess and Tonks comparison map $\phi_X \colon \Ahat(X) \to \schains(\kan(X))$ does not preserve the $\UM$-coalgebra structures, namely, it is not compatible with the lifts $\Ahat_\UM \colon \sSet^0 \to \Mon_{\coAlg_\UM}$
and $\schainsUM \colon \sSet^0 \to \Mon_{\coAlg_\UM}$.
Nevertheless, we construct a zig-zag of natural quasi-isomorphisms of $E_{\infty}$-coalgebras connecting $\Ahat(X)$ and $\schains(\kan(X))$, for any reduced simplicial set $X$.
We summarize this discussion in the following statement.

\begin{theorem} \label{t:2nd main thm in the intro}
	There exists a functor $\Ahat_\UM \colon \sSet^0 \to \Mon_{\coAlg_\UM}$ that fits into a commutative diagram
	\[
	\begin{tikzcd}[row sep=small]
	& \Mon_{\coAlg_\UM} \arrow[d] \\
	& \Mon_{\coAlg} \arrow[d] \\
	\sSet^0
	\arrow[r, "\Ahat"', ]
	\arrow[ru, "\Ahat_{\coAlg}"', out=45, in=180]
	\arrow[ruu, "\Ahat_\UM", out=90, in=180]
	& \Mon_{\Ch}.
	\end{tikzcd}
	\]
	Furthermore, for any reduced simplicial set $X$, there is a zig-zag of natural quasi-isomorphisms of $E_\infty$-coalgebras between $\Ahat_\USL(X)$ and $\schainsUSL(\kan(X))$, where $\USL \subseteq \UM$ is a sub-$E_\infty$-operad.
\end{theorem}

\subsection*{Relation to previous work}

Using more abstract methods, in \cite{hess2006adamshilton} Hess, Parent, Scott, and Tonks constructed a coproduct on $\cobar \schains(X)$ for any $1$-reduced simplicial set $X$, which coincides with Baues' coproduct.
A priori, their methods imply that this coproduct corresponds, up to homotopy, to the Alexander--Whitney coproduct on $\schains(\kan(X))$, a result that Franz showed to hold strictly in \cite{franz2020szczarba}.
Our approach allows us to go beyond the coalgebra structure and compare directly the cobar construction and the chains on the Kan loop group as $E_{\infty}$-coalgebras.

The works of V.A. Smirnov \cite{smirnov1990iterated}, J.R. Smith \cite{smith1994cobar, smith2000operads}, and Kadeishvili–Saneblidze \cite{kadeishvili1998iterating} predict the existence of an $E_\infty$-coalgebra structure on $\cobar \schains(X)$.
In \cite{fresse2010bar}, B. Fresse used a model category structure on reduced operads \cite{berger2003modelcategory, hinich1997homologicalalgebra} to iterate the bar construction on algebras over cofibrant $E_\infty$-operads.
We mention that the reduced version of the $E_{\infty}$-operad $\UM$ is cofibrant, although we do not use this observation here.
In the work of Fresse, finiteness assumptions and restrictions on the fundamental group are required to model the based loop space.

The results we have surveyed establish the existence of higher structures on the bar and cobar constructions associated to reduced simplicial sets.
We now review part of the history of the problem of describing such structures effectively, and our contribution to it.
Kadeishvili described explicitly Steenrod cup-$i$ coproducts on $\cobar \schains(X)$ compatible with its monoid structure \cite{kadeishvili1999coproducts, kadeishvili2003cupi}.
Kadeishvili, as Baues, used cubical methods to define these operations, and to compare them, in the $1$-connected setting, with cup-$i$ coproducts extending the Serre coalgebra structure on the cubical singular chains on the based loop space.
We can regard Kadeishvili's operations as part of the arity 2 action of our model $\UM$ for the $E_{\infty}$-operad.
Taking Kadeishvili's cup-$i$ construction as starting point, Fresse provided the bar construction of an algebra over the surjection operad with the structure of an algebra over the Barratt–Eccles operad \cite{fresse2003hopf}.
Fresse applies this construction to the surjection algebra structure of the cochains on a simplicial set $X$ and compares the resulting Baratt-Eccles algebra to the singular cochains on the based loop space, under restrictions on the fundamental group of $X$.
Our results in the first part of the present article are similar to Fresse's.
However, we make use of coalgebras instead of algebras, which allows us to relate our constructions to the based loop space in the general non-simply connected case.
Additionally, our approach is grounded on and further develops the cubical perspective at the heart of Adams' and Baues' seminal papers.

\subsection*{Outline}

In \cref{s:preliminaries}, we recall well known algebraic and categorical definitions and constructions that will be used throughout this article.
We review, in \cref{s:operads and props}, the foundations of the theory of operads and props with the goal of recalling the $E_{\infty}$-operad $\UM$ and its actions on simplicial and cubical chains.
We construct a Hopf operad structure on $\UM$ in \cref{s:monoidal}, and show that the cubical chains functor from cubical sets to $\UM$-coalgeras is monoidal.
We prove \cref{t:1st main thm in the intro} in \cref{s:theorem1} using Baues' cubical cobar construction and the $\UM$-structure on cubical chains.
Finally, in \cref{s:theorem2}, we review some facts and constructions from homotopy theory and use them to prove \cref{t:2nd main thm in the intro}.